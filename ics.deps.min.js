var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=e.URL||e.webkitURL||e,r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),i=!e.externalHost&&"download"in r,a=e.webkitRequestFileSystem,u=e.requestFileSystem||a||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s="application/octet-stream",d=0,f=[],l=function(){for(var e=f.length;e--;){var t=f[e];"string"==typeof t?o.revokeObjectURL(t):t.remove()}f.length=0},p=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(i){c(i)}}},g=function(o,c){var l,g,R,v=this,E=o.type,h=!1,w=function(){var e=n().createObjectURL(o);return f.push(e),e},b=function(){p(v,"writestart progress write writeend".split(" "))},S=function(){(h||!l)&&(l=w(o)),g?g.location.href=l:window.open(l,"_blank"),v.readyState=v.DONE,b()},y=function(e){return function(){return v.readyState!==v.DONE?e.apply(this,arguments):void 0}},N={create:!0,exclusive:!1};if(v.readyState=v.INIT,c||(c="download"),i){l=w(o),t=e.document,r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r.href=l,r.download=c;var O=t.createEvent("MouseEvents");return O.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(O),v.readyState=v.DONE,void b()}return e.chrome&&E&&E!==s&&(R=o.slice||o.webkitSlice,o=R.call(o,0,o.size,s),h=!0),a&&"download"!==c&&(c+=".download"),(E===s||a)&&(g=e),u?(d+=o.size,void u(e.TEMPORARY,d,y(function(e){e.root.getDirectory("saved",N,y(function(e){var t=function(){e.getFile(c,N,y(function(e){e.createWriter(y(function(t){t.onwriteend=function(t){g.location.href=e.toURL(),f.push(e),v.readyState=v.DONE,p(v,"writeend",t)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&S()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=v["on"+e]}),t.write(o),v.abort=function(){t.abort(),v.readyState=v.DONE},v.readyState=v.WRITING}),S)}),S)};e.getFile(c,{create:!1},y(function(e){e.remove(),t()}),y(function(e){e.code===e.NOT_FOUND_ERR?t():S()}))}),S)}),S)):void S()},R=g.prototype,v=function(e,t){return new g(e,t)};return R.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},R.readyState=R.INIT=0,R.WRITING=1,R.DONE=2,R.error=R.onwritestart=R.onprogress=R.onwrite=R.onabort=R.onerror=R.onwriteend=null,e.addEventListener("unload",l,!1),v.unload=function(){l(),e.removeEventListener("unload",l,!1)},v}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);if("undefined"!=typeof module&&(module.exports=saveAs),"function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof URL)if("function"!=typeof Blob&&"object"!=typeof Blob||"undefined"==typeof webkitURL)var Blob=function(e){"use strict";var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},r=n.prototype,i=o.prototype,a=e.FileReaderSync,u=function(e){this.code=this[this.name=e]},c="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),s=c.length,d=e.URL||e.webkitURL||e,f=d.createObjectURL,l=d.revokeObjectURL,p=d,g=e.btoa,R=e.atob,v=e.ArrayBuffer,E=e.Uint8Array;for(o.fake=i.fake=!0;s--;)u.prototype[c[s]]=s+1;return d.createObjectURL||(p=e.URL={}),p.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof o?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):g?t+";base64,"+g(e.data):t+","+encodeURIComponent(e.data)):f?f.call(d,e):void 0},p.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&l&&l.call(d,e)},r.append=function(e){var n=this.data;if(E&&(e instanceof v||e instanceof E)){for(var r="",i=new E(e),c=0,s=i.length;s>c;c++)r+=String.fromCharCode(i[c]);n.push(r)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new u("NOT_READABLE_ERR");var d=new a;n.push(d.readAsBinaryString(e))}else e instanceof o?"base64"===e.encoding&&R?n.push(R(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},r.getBlob=function(e){return arguments.length||(e=null),new o(this.data.join(""),e,"raw")},r.toString=function(){return"[object BlobBuilder]"},i.slice=function(e,t,n){var r=arguments.length;return 3>r&&(n=null),new o(this.data.slice(e,r>1?t:this.data.length),n,this.encoding)},i.toString=function(){return"[object Blob]"},n}(e);return function(e,n){var o=n?n.type||"":"",r=new t;if(e)for(var i=0,a=e.length;a>i;i++)r.append(e[i]);return r.getBlob(o)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this);else self.URL=webkitURL;var ics=function(){"use strict";if(navigator.userAgent.indexOf("MSIE")>-1&&-1==navigator.userAgent.indexOf("MSIE 10"))return void console.log("Unsupported Browser");var e=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",t=[],n=["BEGIN:VCALENDAR","VERSION:2.0"].join(e),o=e+"END:VCALENDAR";return{events:function(){return t},calendar:function(){return n+e+t.join(e)+o},addEvent:function(n,o,r,i,a){if("undefined"==typeof n||"undefined"==typeof o||"undefined"==typeof r||"undefined"==typeof i||"undefined"==typeof a)return!1;var u=new Date(i),c=new Date(a),s=("0000"+u.getFullYear().toString()).slice(-4),d=("00"+(u.getMonth()+1).toString()).slice(-2),f=("00"+u.getDate().toString()).slice(-2),l=("00"+u.getHours().toString()).slice(-2),p=("00"+u.getMinutes().toString()).slice(-2),g=("00"+u.getMinutes().toString()).slice(-2),R=("0000"+c.getFullYear().toString()).slice(-4),v=("00"+(c.getMonth()+1).toString()).slice(-2),E=("00"+c.getDate().toString()).slice(-2),h=("00"+c.getHours().toString()).slice(-2),w=("00"+c.getMinutes().toString()).slice(-2),b=("00"+c.getMinutes().toString()).slice(-2),S="",y="";p+g+w+b!=0&&(S="T"+l+p+g,y="T"+h+w+b);var N=s+d+f+S,O=R+v+E+y,A=["BEGIN:VEVENT","CLASS:PUBLIC","DESCRIPTION:"+o,"DTSTART:"+N,"RRULE:FREQ=WEEKLY;COUNT=15","DTEND:"+O,"LOCATION:"+r,"SUMMARY;LANGUAGE=en-us:"+n,"TRANSP:TRANSPARENT","END:VEVENT"].join(e);return t.push(A),A},download:function(r,i){if(t.length<1)return!1;i="undefined"!=typeof i?i:".ics",r="undefined"!=typeof r?r:"calendar";var a,u=n+e+t.join(e)+o;if(-1===navigator.userAgent.indexOf("MSIE 10"))a=new Blob([u]);else{var c=new BlobBuilder;c.append(u),a=c.getBlob("text/x-vCalendar;charset="+document.characterSet)}return saveAs(a,r+i),u}}};